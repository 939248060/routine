(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/recySmart/recySmart"],{"13d0":function(t,a,n){"use strict";(function(t){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;getApp();var e=n("716d"),o=n("1ae5"),i=n("33b2"),r=function(){return n.e("components/loading/loading").then(n.bind(null,"5a64"))},s={data:function(){return{host:"",gdkey:"425ae27b23c22857e78eff196685e1f7",checkbin:"smart",mapwidth:0,mapheight:0,latitude:0,longitude:0,smartpanel:!1,drypanel:!1,smartbin:[],drybin:{},location:{},markers:[],single:{}}},components:{loading:r},onLoad:function(){var t=this,a=getApp().globalData;t.$data.host=a.host,t.$data.mapheight=a.systemInfo.windowHeight+50,console.log(a),t.getLocation();var n=new o.AMapWX({key:t.$data.gdkey});n.getRegeo({success:function(t){},fail:function(t){console.log(t)}})},methods:{linkBinList:function(){t.navigateTo({url:"../binlist/binlist"})},getLocation:function(){var a=this,n={};t.getLocation({type:"wgs84",success:function(t){console.log("用户允许获取定位"),n.latitude=t.latitude,n.longitude=t.longitude},fail:function(t){console.log("获取用户位置失败"),n.latitude=20.0076,n.longitude=110.29357},complete:function(t){n.id=0,n.iconPath="../../static/images/location.png",n.width=30,n.height=30;var e=a.$data.markers.concat(n);a.$data.latitude=n.latitude,a.$data.longitude=n.longitude,a.$data.markers=e,a.getSmartBin()}})},getDryBin:function(){var a=this;t.request({url:a.$data.host+"/servlet/drybin/findDryBinPosition",method:"post",header:{"content-type":"application/x-www-form-urlencoded; charset=utf-8"},success:function(t){console.log(t);var n=t.data,e=[];if(e=e.concat(a.$data.location),null!=n&&""!=n){for(var o=0;o<n.length;o++){var i={};i.id=n[o].Code,i.iconPath="../../images/dryposition.png",i.latitude=n[o].Lat,i.longitude=n[o].Lng,i.width=56,i.height=56,e=e.concat(i)}a.$data.markers=e}},fail:function(t){console.log(t),e.showToast(t.errMsg,"none",3e3)}})},getSmartBin:function(){var t=this,a=t.$data.markers;t.$refs["loading"].showColour(),i.postToken("/user/smartBin/findPosition.do",{}).then(function(n){if(0==n.data.status){var o=JSON.parse(n.data.results);console.log(o),a.length=0,o.forEach(function(t){var n={};n.id=t.code,n.iconPath="../../static/images/smart.png",n.latitude=t.lat,n.longitude=t.lng,n.width=70,n.height=70,a=a.concat(n)}),t.$data.markers=a}else e.showToast(n.data.results,"none",3e3)}).catch(function(t){console.log(t),e.showToast(t.errMsg,"none",4e3)}).finally(function(){t.$refs["loading"].hide()})},showSmart:function(){var t=this;"smart"!=t.$data.checkbin&&(t.$data.drypanel=!1,t.$data.checkbin="smart",t.getSmartBin())},showDry:function(){var t=this;"dry"!=t.$data.checkbin&&(t.$data.smartpanel=!1,t.$data.checkbin="dry",t.getDryBin())},hiddenpaenl:function(t){var a=this;a.$data.smartpanel=!1,a.$data.drypanel=!1},showMarker:function(a){var n=this,o=a.markerId,r=n.$data.markers;null!=o&&""!=o&&(o.indexOf("G")>-1?t.request({url:n.$data.host+"/servlet/drybin/findDryBinInfo",method:"post",data:{code:o},header:{"content-type":"application/x-www-form-urlencoded; charset=utf-8"},success:function(t){for(var a=1;a<r.length;a++)r[a].width=56,r[a].height=56,r[a].id==o&&(r[a].width=76,r[a].height=76);n.$data.markers=r;var e=t.data;n.$data.bin=e[0],n.$data.smartpanel=!1,n.$data.drypanel=!0},fail:function(t){console.log(t),e.showToast(t.errMsg,"none",3e3)}}):(console.log(o),n.$refs["loading"].showColour(),i.postToken("/user/smartBin/findInfo.do",{code:o}).then(function(t){if(0==t.data.status){for(var a=JSON.parse(t.data.results),o=n.$data.markers,i=1,r=o.length;i<r;i++)o[i].id==a.code?(o[i].width=90,o[i].height=90):(o[i].width=70,o[i].height=70);n.$data.markers=o,n.$data.single=a,n.$data.drypanel=!1,n.$data.smartpanel=!0}else e.showToast(t.data.results,"none",3e3)}).catch(function(t){console.log(t),e.showToast(t.errMsg,"none",4e3)}).finally(function(){n.$refs["loading"].hide()})))},navToBin:function(){var a=this,n=a.$data.single;t.openLocation({longitude:Number(n.lng),latitude:Number(n.lat),name:n.name,address:n.address})}}};a.default=s}).call(this,n("c11b")["default"])},"40e4":function(t,a,n){"use strict";(function(t){n("4e23"),n("921b");e(n("66fd"));var a=e(n("6bf0"));function e(t){return t&&t.__esModule?t:{default:t}}t(a.default)}).call(this,n("c11b")["createPage"])},"6bf0":function(t,a,n){"use strict";n.r(a);var e=n("d6e6"),o=n("ef53");for(var i in o)"default"!==i&&function(t){n.d(a,t,function(){return o[t]})}(i);n("86ba");var r,s=n("f0c5"),d=Object(s["a"])(o["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],r);a["default"]=d.exports},"86ba":function(t,a,n){"use strict";var e=n("baae"),o=n.n(e);o.a},baae:function(t,a,n){},d6e6:function(t,a,n){"use strict";var e,o=function(){var t=this,a=t.$createElement;t._self._c},i=[];n.d(a,"b",function(){return o}),n.d(a,"c",function(){return i}),n.d(a,"a",function(){return e})},ef53:function(t,a,n){"use strict";n.r(a);var e=n("13d0"),o=n.n(e);for(var i in e)"default"!==i&&function(t){n.d(a,t,function(){return e[t]})}(i);a["default"]=o.a}},[["40e4","common/runtime","common/vendor"]]]);