(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/addressform/addressform"],{"1d83":function(a,e,t){},"49a7":function(a,e,t){"use strict";var n=t("1d83"),r=t.n(n);r.a},"564d":function(a,e,t){"use strict";(function(a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;getApp();var n=t("716d"),r=t("3823"),o=t("99c0"),s=t("33b2"),d=function(){return t.e("components/loading/loading").then(t.bind(null,"5a64"))},i={components:{loading:d},data:function(){return{host:"",addId:"",address:{},single:{},region:[{areaId:1,areaName:"海南省"},{areaId:2,areaName:"海口市"},{areaId:3,areaName:"秀英区"}],regionInfo:[],value:[0,0,0],province:[],city:[],area:[],pikerScenes:!1}},onLoad:function(a){var e=this,t=a.id;if(o.isNotEmpty(t))e.getDetailed(t);else{var n=r.areaParent(0),s=r.areaParent(n[0]["areaId"]),d=r.areaParent(s[0]["areaId"]);e.$data.province=n,e.$data.city=s,e.$data.area=d}},methods:{getDetailed:function(a){var e=this;e.$refs["loading"].showColour(),s.postToken("/address/user/findById.do",{id:a}).then(function(t){if(0===t.data.status){var r=JSON.parse(t.data.results);console.log(r);for(var o=r.areaIds.split(","),s=r.area.split(" "),d=[],i=0;i<s.length;i++){var l={};l.areaId=o[i],l.areaName=s[i],d.push(l)}e.getAreaList(d[0]["areaId"],d[1]["areaId"],d[2]["areaId"]),e.$data.region=d,e.$data.addId=a,e.$data.single=r}else n.showToast(t.data.results,"none",5e3)}).catch(function(a){console.log(a),n.showToast(a,"none",5e3)}).finally(function(){e.$refs["loading"].hide()})},bindChange:function(a){var e,t=this,n=a.detail.value;t.$data.regionInfo;console.log(n);var o=r.areaParent("0"),s=o[n[0]],d=r.areaParent(s["areaId"]),i=d.length;i<n[1]+1&&(n[1]=0);var l=d[n[1]],c=r.areaParent(l["areaId"]),u=c.length;u<n[2]+1&&(n[2]=0);var f=c[n[2]];e=[s,l,f],t.$data.province=o,t.$data.city=d,t.$data.area=c,t.$data.value=n,t.$data.regionInfo=e},getAreaList:function(a,e,t){for(var n=this,o=[],s=r.areaParent("0"),d=0;d<s.length;d++)s[d]["areaId"]==a&&(o[0]=d);console.log(s);for(var i=r.areaParent(a),l=0;l<i.length;l++)i[l]["areaId"]==e&&(o[1]=l);for(var c=r.areaParent(e),u=0;u<c.length;u++)c[u]["areaId"]==t&&(o[2]=u);n.$data.province=s,n.$data.city=i,n.$data.area=c,n.$data.value=o},pikerScenesTap:function(){var a=this,e=a.$data.pikerScenes,t=1!=e;a.$data.regionInfo=a.$data.region,a.$data.pikerScenes=t},pikerConfirm:function(){var a=this,e=a.$data.regionInfo;null!=e&&""!=e&&(a.$data.region=a.$data.regionInfo),a.pikerScenesTap()},pikerCancel:function(){var a=this;a.pikerScenesTap()},getLocation:function(){var a=new amapFile.AMapWX({key:"sa3fdbd001d903290e836c26420f011bfr"});a.getRego({success:function(a){console.log(a,a[0].regeocodeData.formatted_address)}})},sendForm:function(e){var t=this,r={},d="/address/user/add.do";o.isNotEmpty(t.$data.single.addressId)&&(r.addressId=t.$data.single.addressId,d="/address/user/update.do"),r.contact=e.detail.value.contact,r.tel=e.detail.value.tel,r.address=e.detail.value.address,r.room=e.detail.value.room;var i=t.$data.region;return 0==o.isChinese(r.contact)||0==o.isLong(r.contact,"2,8")?(n.showToast("联系人必须由2到8个字的中文组成","none",2e3),!1):0==o.isMobile(r.tel)?(n.showToast("请输入正确手机号","none",2e3),!1):0==r.address.length?(n.showToast("请输入详细地址","none",2e3),!1):0==o.isLong(r.address,"1,30")?(n.showToast("详细地址不能超过30个字符","none",2e3),!1):0==r.room.length?(n.showToast("请输入门牌号","none",2e3),!1):0==o.isLong(r.room,"1,20")?(n.showToast("门牌号不能超过20个字符","none",2e3),!1):(t.$refs["loading"].showTrans(),r.areaIds=i[0]["areaId"]+","+i[1]["areaId"]+","+i[2]["areaId"],r.areaId=i[2]["areaId"],r.area=i[0]["areaName"]+" "+i[1]["areaName"]+" "+i[2]["areaName"],void s.postToken(d,{data:JSON.stringify(r)}).then(function(e){if(0===e.data.status){var t=getCurrentPages();if(t.length>1){var r=t[t.length-2];r.onShow(),a.navigateBack({delta:1})}}else n.showToast(e.data.results,"none",5e3)}).catch(function(a){console.log(a),n.showToast(a,"none",5e3)}).finally(function(){t.$refs["loading"].hide()}))},getAddress:function(e){var t=this,r=a.getStorageSync("custToken");o.isEmpty(r)&&a.redirectTo({url:"../login/login"}),t.$refs["loading"].showColour(),a.request({url:t.data.host+"/address/user/findById.do",method:"post",data:{id:e},header:{"content-type":"application/x-www-form-urlencoded; charset=utf-8",token:r},success:function(a){if(200==a.statusCode){n.isLogin(a.header);var r=a.data;if(console.log(r),0==r.status){for(var o=JSON.parse(r.results),s=o.areaIds.split(","),d=o.area.split(" "),i=[],l=0;l<d.length;l++){var c={};c.areaId=s[l],c.areaName=d[l],i.push(c)}t.getAreaList(i[0]["areaId"],i[1]["areaId"],i[2]["areaId"]),t.$data.region=i,t.$data.addId=e,t.$data.address=o}else n.showToast(r.results,"none",3e3)}else n.showToast("发生未知错误："+a.statusCode,"none",3e3)},fail:function(a){console.log(a),n.showToast(a.errMsg,"none",3e3)},finally:function(){t.$refs["loading"].hide()}})}}};e.default=i}).call(this,t("c11b")["default"])},"91df":function(a,e,t){"use strict";(function(a){t("4e23"),t("921b");n(t("66fd"));var e=n(t("fd3e"));function n(a){return a&&a.__esModule?a:{default:a}}a(e.default)}).call(this,t("c11b")["createPage"])},babb:function(a,e,t){"use strict";var n,r=function(){var a=this,e=a.$createElement;a._self._c},o=[];t.d(e,"b",function(){return r}),t.d(e,"c",function(){return o}),t.d(e,"a",function(){return n})},ca1f:function(a,e,t){"use strict";t.r(e);var n=t("564d"),r=t.n(n);for(var o in n)"default"!==o&&function(a){t.d(e,a,function(){return n[a]})}(o);e["default"]=r.a},fd3e:function(a,e,t){"use strict";t.r(e);var n=t("babb"),r=t("ca1f");for(var o in r)"default"!==o&&function(a){t.d(e,a,function(){return r[a]})}(o);t("49a7");var s,d=t("f0c5"),i=Object(d["a"])(r["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);e["default"]=i.exports}},[["91df","common/runtime","common/vendor"]]]);