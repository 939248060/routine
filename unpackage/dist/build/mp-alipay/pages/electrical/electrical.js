(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/electrical/electrical"],{"11ba":function(t,a,e){"use strict";(function(t){e("4e23"),e("921b");n(e("66fd"));var a=n(e("bdc1"));function n(t){return t&&t.__esModule?t:{default:t}}t(a.default)}).call(this,e("c11b")["createPage"])},"83ea":function(t,a,e){"use strict";var n=e("8882"),c=e.n(n);c.a},8882:function(t,a,e){},a32a:function(t,a,e){"use strict";(function(t,n){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=getApp(),s=e("716d"),r=e("99c0"),o=e("6167"),i=e("33b2"),d=function(){return e.e("components/loading/loading").then(e.bind(null,"5a64"))},l={data:function(){return{host:"",list:[],address:"",selectHid:!1,finishHid:!1,selectItem:[],subItem:[],tempImages:[],images:[],recydetail:[],count:-1,countDetail:-1}},components:{loading:d},onLoad:function(){var t=this;t.getAll()},onShow:function(){var a=this,e=t.getStorageSync("address");null!=e&&(console.log(a.address),a.address=e)},methods:{errImg:function(t){var a=this,e=a.$data.list,n=t.target.dataset.idx;e[n].img=c.globalData.host+"/images/routine/noimage.png",a.$data.list=e},getAll:function(){var t=this;i.postToken("/scrap/user/findAll.do",{state:2}).then(function(a){if(0===a.data.status){var e=JSON.parse(a.data.results);e.forEach(function(t){0==t.parentId&&(t.img=c.globalData.host+"/images/routine/"+o.toPinyin(t.name)+".png",t.image=o.toPinyin(t.name)+".png",t.css="")}),t.$data.list=e}else s.showToast(a.data.results,"none",4e3)}).catch(function(t){console.log(t),s.showToast(t,"none",4e3)})},tapOpenSelectPanel:function(t){var a=this;a.$data.selectHid=!0},tapCloseSelectPanel:function(t){var a=this,e=a.$data.list;e.forEach(function(t){0==t.parentId&&(t.css="")}),a.$data.list=e,a.$data.selectHid=!1,a.$data.selectItem=[],a.$data.subItem=[],a.$data.count=-1},tapChooseImage:function(){var t=this,a=t.$data.tempImages,e=t.$data.images;a.length>=4||n.chooseImage({success:function(n){var c=n.tempFilePaths;i.uploadToken("/recyorder/user/uploadImage.do",c[0]).then(function(n){var r=JSON.parse(n.data);0===r.status?(a=a.concat(c),e=e.concat(JSON.parse(r.results)),t.$data.tempImages=a,t.$data.images=e):(console.log(r.results),s.showToast(r.results,"none",5e3))}).catch(function(t){console.log(t),s.showToast(t,"none",5e3)})}})},tapPreviewImage:function(a){var e=this,n=a.target.dataset.idx,c=e.$data.tempImages;t.previewImage({current:c[n],urls:c})},tapRemoveImage:function(t){var a=this,e=t.target.dataset.idx,n=a.$data.tempImages,c=a.$data.images;n.splice(e,1),c.splice(e,1),a.$data.tempImages=n,a.$data.images=c},tapToggle:function(t){var a=this,e=t.currentTarget.dataset.idx,n=a.$data.list,c=a.$data.selectItem,s=n[e];c.splice(0,c.length,s);var r=a.ergodicScrap(n,s.scrapId),o=0==r.length?a.countPrice(c):-1;n.forEach(function(t){0==t.parentId&&(t.css=t.scrapId==s.scrapId?"selected":"")}),a.$data.list=n,a.$data.selectItem=c,a.$data.subItem=r,a.$data.count=o},tapSelectItem:function(t){var a=this,e=a.$data.list,n=t.currentTarget.dataset.idx,c=a.$data.selectItem,s=a.ergodicScrap(e,c[n].parentId);0!=s.length&&(c.splice(n,c.length-n),a.$data.selectItem=c,a.$data.subItem=s,a.$data.count=-1)},tapSubItem:function(t){var a=this,e=a.$data.list,n=t.currentTarget.dataset.obj,c=a.$data.selectItem.concat(n),s=a.ergodicScrap(e,n.scrapId),r=0==s.length?a.countPrice(c):-1;a.$data.selectItem=c,a.$data.subItem=s,a.$data.count=r},tapAddScrap:function(t){var a=this;if(!(a.$data.count<0)){for(var e=a.$data.selectItem,n={scrapIds:"",scrapNames:"",score:"",price:"",totalScore:0,totalPrice:0},c=0,r=e.length;c<r;c++){var o=e[c];c>0?(n.scrapIds+=";",n.scrapNames+=";",n.score+=";",n.price+=";"):(n.scrapId=o.scrapId,n.scrapName=o.name,n.img=o.img,n.image=o.image),n.scrapIds+=o.scrapId,n.scrapNames+=o.name,n.score+=o.score,n.price+=o.price,n.totalScore+=o.score,n.totalPrice+=o.price}var i=a.$data.recydetail.concat(n),d=a.countPrice(i,"detail");a.$data.recydetail=i,a.$data.countDetail=d,s.showToast("添加成功","none",2e3)}},tapRemoveDetail:function(t){var a=this,e=t.currentTarget.dataset.idx,n=a.$data.recydetail;n.splice(e,1);var c=a.countPrice(n,"detail");a.$data.recydetail=n,a.$data.countDetail=c},sendForm:function(t){var a=this,e=a.$data.address,n=a.$data.images,c=a.$data.countDetail,o=a.$data.recydetail;if(c<0||o.length<1)return!1;if(r.isEmpty(e.contact))return s.showToast("请选择收货地址","none",4e3),!1;a.$refs["loading"].showColour();var d=e;d.remarks=t.detail.value.remarks,d.totalPrice=c,d.recyType=2;for(var l=0,u=n.length;l<u;l++)l>0?d.images+=";":d.images="",d.images+=n[l];console.log(d);var f={data:JSON.stringify(d),recydetail:JSON.stringify(o)};i.postToken("/recyorder/user/electrical.do",f).then(function(t){0===t.data.status?(s.showToast(t.data.results,"none",3e3),a.$data.finishHid=!0):s.showToast(t.data.results,"none",5e3)}).catch(function(t){console.log(t),s.showToast(t,"none",5e3)}).finally(function(){a.$refs["loading"].hide()})},ergodicScrap:function(t,a){var e=[];return t.forEach(function(t){t.parentId==a&&e.push(t)}),e},countPrice:function(t,a){var e=0;return t.forEach(function(t){e+="detail"==a?r.isNotEmpty(t.totalPrice)?t.totalPrice:0:r.isNotEmpty(t.price)?t.price:0}),e},addItem:function(t,a){var e=this,n=[];return t.forEach(function(c){a==c.parentId&&(c.children=e.addItem(t,c.scrapId),n.push(c))}),n}}};a.default=l}).call(this,e("c11b")["default"],e("c11b")["default"])},b955:function(t,a,e){"use strict";var n,c=function(){var t=this,a=t.$createElement;t._self._c},s=[];e.d(a,"b",function(){return c}),e.d(a,"c",function(){return s}),e.d(a,"a",function(){return n})},bdc1:function(t,a,e){"use strict";e.r(a);var n=e("b955"),c=e("e221");for(var s in c)"default"!==s&&function(t){e.d(a,t,function(){return c[t]})}(s);e("83ea");var r,o=e("f0c5"),i=Object(o["a"])(c["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],r);a["default"]=i.exports},e221:function(t,a,e){"use strict";e.r(a);var n=e("a32a"),c=e.n(n);for(var s in n)"default"!==s&&function(t){e.d(a,t,function(){return n[t]})}(s);a["default"]=c.a}},[["11ba","common/runtime","common/vendor"]]]);